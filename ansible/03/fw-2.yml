- name: pfSense Check
  hosts: fw2
  gather_facts: False

  tasks:

  - name: Ping Check
    ping:

  - name: General Setup Check
    pfsensible.core.pfsense_setup:
      hostname: "FW-2"
      domain: yargu
      dns_addresses: 8.8.8.8
      timezone: Europe/Moscow

  - name: Check private ang bogon disabled
    pfsensible.core.pfsense_interface:
      blockbogons: False
      blockpriv: False
      descr: "{{ 'WAN' if inventory_hostname == 'fw1' else 'DMZ' }}"
      interface: 'em0'
      # Все параметры ниже приходится использовать, т.к. значения по умолчанию этих параметров не соотвествуют проверяемым
      # Возможно стоит отдельно сделать проверку по каждому интерфейсу
      enable: True
      ipv4_type: "{{ 'dhcp' if inventory_hostname == 'fw1' else 'static' }}"
      # Два параметра ниже будут использоваться только при 'static'
      ipv4_address: "{{ fw2_dmz_ip }}"
      ipv4_gateway: "WANGW"
